<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>BARSTAGEplot</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
</head>
<body>

    <header id="top-bar">
        <h1>BARSTAGEplot</h1>
        <div class="file-actions">
            <button class="btn" id="new-project-btn"><i class="fas fa-file"></i> Nuevo</button>
            <button class="btn" id="save-project-btn"><i class="fas fa-save"></i> Guardar</button>
            <button class="btn" id="load-project-btn"><i class="fas fa-folder-open"></i> Cargar</button>
            <div class="export-menu">
                <button class="btn" id="export-project-btn"><i class="fas fa-share-square"></i> Exportar</button>
                <button class="btn" id="print-rider-btn"><i class="fas fa-print"></i> Imprimir Rider</button>
            </div>
            <button class="btn" id="preferences-btn"><i class="fas fa-cog"></i> Preferencias</button>
        </div>

        <div id="project-info-display">
            <span>Proyecto: <strong id="header-project-name">N/A</strong></span>
            <span>Gira: <strong id="header-tour-name">N/A</strong></span>
            <span>Escenario: <strong id="header-stage-size">N/A</strong></span>
            <span>Ch. Entrada: <strong id="header-channels">0</strong></span>
            <span>Envíos: <strong id="header-sends">0</strong></span>
        </div>

        <button id="theme-toggle" class="btn theme-day" title="Cambiar Tema">
            <i class="fas fa-moon"></i> Día/Noche
        </button>
    </header>

    <div id="main-container">
        <section id="project-init-screen" class="app-screen active">
            <h2><i class="fas fa-cogs"></i> Diseño Inicial del Proyecto</h2>
            <form id="project-form">
                <label for="project-name">Nombre del proyecto:</label>
                <input type="text" id="project-name" required>

                <label for="tour-name">Nombre de la gira:</label>
                <input type="text" id="tour-name">

                <label for="date">Fecha:</label>
                <input type="date" id="date">

                <label for="stage-size">Tamaño de escenario (Ancho x Alto):</label>
                <input type="text" id="stage-size" placeholder="Ej: 8m x 6m" required>

                <label for="input-channels">Canales de entrada:</label>
                <input type="number" id="input-channels" min="0" value="0" required>

                <label for="sends-count">Cantidad de envíos:</label>
                <input type="number" id="sends-count" min="0" value="0" required>

                <button type="submit" class="btn primary-btn"><i class="fas fa-project-diagram"></i> Crear Proyecto</button>
            </form>
        </section>

        <nav id="main-nav">
            <button class="tab-button" data-tab="stage-plot"><i class="fas fa-drafting-compass"></i> PLANO</button>
            <button class="tab-button" data-tab="input-list"><i class="fas fa-list-alt"></i> LISTA DE CANALES</button>
            <button class="tab-button" data-tab="sends-list"><i class="fas fa-volume-up"></i> ENVÍOS</button>
            <button class="tab-button" data-tab="foh-config"><i class="fas fa-sliders-h"></i> FOH</button>
            <button class="tab-button" data-tab="rider-menu"><i class="fas fa-file-contract"></i> RIDER</button>
        </nav>

        <div id="tab-content">

            <section id="stage-plot" class="tab-screen">
                <aside id="element-palette">
                    <h3>Elementos <i class="fas fa-box-open"></i></h3>
                    <div id="palette-tabs">
                        <button class="palette-tab-button active" data-category="general" title="General"><i class="fas fa-cubes"></i></button>
                        <button class="palette-tab-button" data-category="mics" title="Micrófonos"><i class="fas fa-microphone"></i></button>
                        <button class="palette-tab-button" data-category="instruments" title="Instrumentos"><i class="fas fa-guitar"></i></button>
                        <button class="palette-tab-button" data-category="shapes" title="Formas"><i class="fas fa-square"></i></button>
                        <button class="palette-tab-button" data-category="text" title="Texto/Etiquetas"><i class="fas fa-font"></i></button>
                        <!-- Añadidas categorías adicionales por si se desean más elementos -->
                        <button class="palette-tab-button" data-category="lighting" title="Iluminación"><i class="fas fa-lightbulb"></i></button>
                        <button class="palette-tab-button" data-category="video" title="Vídeo"><i class="fas fa-video"></i></button>
                    </div>

                    <div id="palette-content">
                        <div id="category-general" class="palette-category active">
                            <div class="stage-icon" draggable="true" data-type="wedge"><i class="fas fa-volume-down"></i> Monitor Cuña</div>
                            <div class="stage-icon" draggable="true" data-type="speaker"><i class="fas fa-bullhorn"></i> PA</div>
                            <div class="stage-icon" draggable="true" data-type="drum-set"><i class="fas fa-drum"></i> Batería</div>
                            <div class="stage-icon" draggable="true" data-type="guitar-amp"><i class="fas fa-guitar"></i> Ampli Guitarra</div>
                            <div class="stage-icon" draggable="true" data-type="bass-amp"><i class="fas fa-volume-up"></i> Ampli Bajo</div>
                            <div class="stage-icon" draggable="true" data-type="keyboard"><i class="fas fa-compact-disc"></i> Teclado</div>
                            <div class="stage-icon" draggable="true" data-type="vocalist"><i class="fas fa-user-circle"></i> Vocalista</div>
                            <div class="stage-icon" draggable="true" data-type="musician"><i class="fas fa-user"></i> Músico</div>
                        </div>
                        <div id="category-mics" class="palette-category">
                            <div class="stage-icon" draggable="true" data-type="mic-stand"><i class="fas fa-microphone-alt"></i> Micrófono Pie Alto</div>
                            <div class="stage-icon" draggable="true" data-type="mic-short-stand"><i class="fas fa-microphone"></i> Micrófono Pie Bajo</div>
                            <div class="stage-icon" draggable="true" data-type="di-box"><i class="fas fa-box"></i> Caja DI</div>
                            <div class="stage-icon" draggable="true" data-type="condenser"><i class="fas fa-podcast"></i> Condensador</div>
                        </div>
                        <div id="category-instruments" class="palette-category">
                            <div class="stage-icon" draggable="true" data-type="guitar"><i class="fas fa-guitar"></i> Guitarra</div>
                            <div class="stage-icon" draggable="true" data-type="bass"><i class="fas fa-guitar"></i> Bajo</div>
                            <div class="stage-icon" draggable="true" data-type="piano"><i class="fas fa-piano"></i> Piano</div>
                            <div class="stage-icon" draggable="true" data-type="sax"><i class="fas fa-saxophone"></i> Saxofón</div>
                            <div class="stage-icon" draggable="true" data-type="percussion"><i class="fas fa-bell"></i> Percusión</div>
                        </div>
                        <div id="category-shapes" class="palette-category">
                            <div class="stage-icon" data-type="square-shape" draggable="true"><i class="fas fa-square"></i> Cuadrado</div>
                            <div class="stage-icon" data-type="circle-shape" draggable="true"><i class="fas fa-circle"></i> Círculo</div>
                            <div class="stage-icon" data-type="line-shape" draggable="true"><i class="fas fa-minus"></i> Línea</div>
                        </div>
                        <div id="category-text" class="palette-category">
                            <div class="stage-icon" draggable="true" data-type="text"><i class="fas fa-align-left" style="display: none;"></i> Etiqueta de Texto</div>
                        </div>
                        <div id="category-lighting" class="palette-category">
                            <div class="stage-icon" draggable="true" data-type="par-light"><i class="fas fa-lightbulb"></i> PAR</div>
                            <div class="stage-icon" draggable="true" data-type="moving-head"><i class="fas fa-bolt"></i> Moving Head</div>
                        </div>
                        <div id="category-video" class="palette-category">
                            <div class="stage-icon" draggable="true" data-type="projector"><i class="fas fa-video"></i> Proyector</div>
                            <div class="stage-icon" draggable="true" data-type="screen"><i class="fas fa-tv"></i> Pantalla</div>
                        </div>
                    </div>
                </aside>

                <main id="canvas-area">
                    <div id="stage-canvas" class="a4-proportional show-grid">
                        <p class="canvas-placeholder">Arrastra y suelta elementos aquí. (Plano Proporcional A4)</p>
                    </div>
                </main>

                <aside id="element-config-panel">
                    <h3>Configuración <i class="fas fa-palette"></i></h3>
                    <p class="config-placeholder">Selecciona un elemento en el plano para configurar sus propiedades.</p>

                    <div id="canvas-controls" class="pref-section">
                        <h4>Opciones del Plano</h4>
                        <label for="grid-toggle">
                            <input type="checkbox" id="grid-toggle" checked> Mostrar Rejilla
                        </label>
                    </div>

                    <div id="element-controls" style="display: none;">
                        <h4 id="selected-element-title">Elemento Seleccionado</h4>

                        <label for="element-name-input">Nombre/Etiqueta:</label>
                        <input type="text" id="element-name-input">
                        <label for="color-picker">Color de Fondo:</label>
                        <input type="color" id="color-picker">

                        <label for="shape-selector">Forma:</label>
                        <select id="shape-selector">
                            <option value="square">Cuadrado</option>
                            <option value="circle">Círculo</option>
                            <option value="line">Línea</option>
                        </select>

                        <label for="z-index-selector">Nivel de Profundidad (Z-Index):</label>
                        <input type="number" id="z-index-selector" min="1" max="100" value="10">

                        <label for="scale-selector">Escala:</label>
                        <input type="range" id="scale-selector" min="0.5" max="2.0" step="0.1" value="1.0">

                        <button id="delete-element-btn" class="btn primary-btn" style="background-color: #dc3545;"><i class="fas fa-trash"></i> Eliminar Elemento</button>
                    </div>
                </aside>
            </section>

            <section id="input-list" class="tab-screen">
                <h2><i class="fas fa-list-alt"></i> Lista de Canales (Input List)</h2>
                <button id="add-input-channel-btn" class="btn primary-btn add-btn-top"><i class="fas fa-plus"></i> Añadir Canal</button>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Ch</th>
                            <th>Nombre de canal</th>
                            <th>Mic/DI</th>
                            <th>Phantom</th>
                            <th>Pie</th>
                            <th>Sub-Snake</th>
                            <th>Notas</th>
                            <th>Eliminar</th>
                        </tr>
                    </thead>
                    <tbody id="input-list-body">
                    </tbody>
                </table>
            </section>

            <section id="sends-list" class="tab-screen">
                <h2><i class="fas fa-volume-up"></i> Envíos (Sends List)</h2>
                <button id="add-send-btn" class="btn primary-btn add-btn-top"><i class="fas fa-plus"></i> Añadir Envío</button>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Send</th>
                            <th>Nombre</th>
                            <th>Tipo</th>
                            <th>Mix</th>
                            <th>EQ/FX</th>
                            <th>Notas</th>
                            <th>Eliminar</th>
                        </tr>
                    </thead>
                    <tbody id="sends-list-body">
                    </tbody>
                </table>
            </section>

            <section id="foh-config" class="tab-screen">
                <h2><i class="fas fa-sliders-h"></i> Configuración FOH</h2>
                <form id="foh-config-form" class="pref-section">
                    <h4>Configuración de Consola</h4>
                    <label for="foh-console-model">Modelo de Consola:</label>
                    <input type="text" id="foh-console-model" value="Modelo de Consola" required>

                    <label for="foh-patch-details">Detalles de Patching:</label>
                    <textarea id="foh-patch-details" rows="4">Entradas 1-16 en preamps. Buses de salida: L/R (PA), Aux 1-4 (Monitores).</textarea>

                    <button type="submit" class="btn primary-btn"><i class="fas fa-save"></i> Guardar Configuración FOH</button>
                </form>
            </section>

        </div>

        <section id="rider-menu" class="tab-screen">
            <h2><i class="fas fa-file-contract"></i> Rider Técnico (Vista final)</h2>

            <div class="pref-section">
                <h3>Información / Notas del Rider</h3>
                <p id="rider-contact" contenteditable="true">Manager: [Nombre] - [Teléfono] - [Email]</p>
                <p id="rider-sound" contenteditable="true">Técnico de Sonido: [Nombre] - [Teléfono] - [Email]</p>
            </div>

            <div class="pref-section">
                <h3>Vista final (Plano, Listas y Envíos)</h3>
                <p style="font-size:0.95em; color:var(--color-text);">Aquí se muestra la vista final combinada tal como se exportará/imprimirá: primero la información del Rider, luego el plano (sin rejilla) y las listas. La columna "Eliminar" está oculta en esta vista final.</p>

                <div id="rider-preview" class="rider-preview">
                    <!-- El preview se genera dinámicamente por script.js -->
                </div>
            </div>
        </section>

        <section id="preferences-screen" class="app-screen">
            <div class="preferences-container">
                <h2 class="pref-title"><i class="fas fa-cog"></i> Preferencias del Proyecto</h2>

                <div class="pref-section">
                    <h3>Información y Canales</h3>
                    <form id="project-preferences-form">
                        <label for="pref-project-name">Nombre del proyecto:</label>
                        <input type="text" id="pref-project-name" required>

                        <label for="pref-tour-name">Nombre de la gira:</label>
                        <input type="text" id="pref-tour-name">

                        <label for="pref-date">Fecha:</label>
                        <input type="date" id="pref-date">

                        <label for="pref-stage-size">Tamaño de escenario (Ancho x Alto):</label>
                        <input type="text" id="pref-stage-size" placeholder="Ej: 8m x 6m" required>

                        <label for="pref-input-channels">Canales de entrada:</label>
                        <input type="number" id="pref-input-channels" min="0" required>

                        <label for="pref-sends-count">Cantidad de envíos:</label>
                        <input type="number" id="pref-sends-count" min="0" required>

                        <button type="submit" class="btn primary-btn"><i class="fas fa-save"></i> Guardar Cambios</button>
                    </form>
                </div>

                <div class="pref-section">
                    <h3>Otros Ajustes</h3>
                    <p>Modo Día/Noche: Usa el botón en la barra superior para cambiar el tema visual.</p>
                </div>

                <button id="close-preferences-btn" class="btn"><i class="fas fa-times"></i> Cerrar</button>
            </div>
        </section>

    </div>

    <script src="script.js"></script>
</body>
</html>
